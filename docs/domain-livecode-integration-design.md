# åŸŸåæ± ä¸æ´»ç é›†æˆè®¾è®¡æ–¹æ¡ˆ

**Document ID**: domain-livecode-integration-design-v1.0
**Created**: 2026-01-18
**Status**: Approved for Implementation

---

## 1. è®¾è®¡ç›®æ ‡

å°†åŸŸåæ± ç®¡ç†ä¸æ´»ç ç®¡ç†ç³»ç»Ÿæ·±åº¦é›†æˆï¼Œå®ç°ï¼š
1. **ä¸»åŸŸåé”å®šæœºåˆ¶**ï¼šä¸»åŸŸåä¸€æ—¦ç»‘å®šåˆ°æ´»ç ç»„ï¼Œä¸å¯ä¿®æ”¹ï¼ˆéœ€ç®¡ç†å‘˜å¼ºåˆ¶è§£ç»‘ï¼‰
2. **ç‚®ç°åŸŸåçµæ´»ç®¡ç†**ï¼šå¤‡ç”¨åŸŸåå¯éšæ—¶æ·»åŠ ã€åˆ é™¤ã€è°ƒæ•´
3. **æ™ºèƒ½æ•…éšœè½¬ç§»**ï¼šä¸»åŸŸåå¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨åŸŸå
4. **å¤šæ´»ç ç»„å…±äº«**ï¼šä¸€ä¸ªåŸŸåæ± æœåŠ¡å¤šä¸ªæ´»ç ç»„

---

## 2. æ ¸å¿ƒçº¦æŸ

| åŸŸåç±»å‹ | ç»‘å®šåå¯ä¿®æ”¹æ€§ | è§£ç»‘é™åˆ¶ |
|---------|--------------|---------|
| ä¸»åŸŸå | âŒ ä¸å¯ä¿®æ”¹ | ä»…ç®¡ç†å‘˜å¯å¼ºåˆ¶è§£ç»‘ |
| å¤‡ç”¨åŸŸå | âœ… å®Œå…¨çµæ´» | éšæ—¶å¯è§£ç»‘ |

**è®¾è®¡åŸåˆ™**ï¼š
- ä¸»åŸŸå = ç”Ÿäº§ç¯å¢ƒçš„"æ°¸ä¹…å…¥å£"ï¼ˆé”å®šåä¿æŠ¤ç¨³å®šæ€§ï¼‰
- å¤‡ç”¨åŸŸå = å¼¹æ€§å®¹é”™èµ„æºï¼ˆå¯åŠ¨æ€è°ƒæ•´ï¼‰

---

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 æ´»ç æ•°æ®æ‰©å±•

åœ¨ `LiveCode` ä¸­æ·»åŠ åŸŸåé…ç½®ï¼š

```typescript
interface DomainConfig {
  // ç»‘å®šæ¨¡å¼
  mode: 'GLOBAL_POOL' | 'CUSTOM_DOMAINS' | 'HYBRID';

  // ä¸»åŸŸåé…ç½®ï¼ˆé”å®šåä¸å¯ä¿®æ”¹ï¼‰
  primaryDomain?: {
    domainId: string;        // åŸŸåæ± ä¸­çš„åŸŸåID
    domain: string;          // åŸŸå
    protocol: 'http' | 'https';
    lockedAt: string;        // é”å®šæ—¶é—´æˆ³
    locked: boolean;         // é”å®šçŠ¶æ€
    canUnbind: boolean;      // æ˜¯å¦å…è®¸è§£ç»‘ï¼ˆé€šå¸¸ä¸ºfalseï¼‰
  };

  // å¤‡ç”¨åŸŸåé…ç½®ï¼ˆå®Œå…¨çµæ´»ï¼‰
  fallbackDomains: {
    domainIds: string[];     // å¤‡ç”¨åŸŸåIDåˆ—è¡¨
    priority: number[];      // ä¼˜å…ˆçº§é¡ºåº
    updatedAt: string;       // æœ€åæ›´æ–°æ—¶é—´
    failoverEnabled: boolean; // æ˜¯å¦å¯ç”¨æ•…éšœè½¬ç§»
  };

  // åŸŸåé€‰æ‹©ç­–ç•¥
  strategy: 'round-robin' | 'random' | 'weighted' | 'priority';
}
```

### 3.2 åŸŸåæ± æ•°æ®æ‰©å±•

åœ¨ `Domain` ä¸­æ·»åŠ ç»‘å®šè¿½è¸ªï¼š

```typescript
interface DomainBindingInfo {
  domainId: string;
  boundToLiveCodes: {
    liveCodeId: string;
    role: 'primary' | 'fallback';  // ç»‘å®šè§’è‰²
    boundAt: string;                // ç»‘å®šæ—¶é—´
  }[];
}
```

### 3.3 æ´»ç ç»Ÿè®¡æ•°æ®æ‰©å±•

```typescript
interface LiveCodeStats {
  // ... ç°æœ‰å­—æ®µ

  // åŸŸåç›¸å…³ç»Ÿè®¡
  domainStats: {
    primaryDomainSuccess: number;
    primaryDomainFailure: number;
    fallbackDomainUsage: number;
    lastFailoverTime?: string;
    currentUsingDomain: 'primary' | 'fallback';
  };
}
```

---

## 4. ä¸šåŠ¡æµç¨‹è®¾è®¡

### 4.1 ä¸»åŸŸåç»‘å®šæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ´»ç é…ç½®é¡µé¢ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é€‰æ‹©ä¸»åŸŸå      â”‚ â”€â”€â”€â†’ éªŒè¯åŸŸåçŠ¶æ€ï¼ˆå¿…é¡»æ˜¯ activeï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¡®è®¤ç»‘å®šè­¦å‘Š    â”‚ â”€â”€â”€â†’ "ä¸»åŸŸåç»‘å®šåä¸å¯ä¿®æ”¹ï¼Œç¡®å®šå—ï¼Ÿ"
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ ç¡®è®¤
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡Œç»‘å®š        â”‚
â”‚ - è®¾ç½®locked=true â”‚
â”‚ - è®°å½•lockedAt   â”‚
â”‚ - canUnbind=false â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ›´æ–°åŸŸåæ± ç»Ÿè®¡  â”‚
â”‚ - æ ‡è®°åŸŸåå·²ç»‘å®š â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é”å®šä¿æŠ¤æœºåˆ¶**ï¼š
```typescript
// å°è¯•ä¿®æ”¹ä¸»åŸŸåæ—¶
if (domainConfig.primaryDomain?.locked) {
  if (!user.isAdmin || !request.forceUnbind) {
    throw new Error('ä¸»åŸŸåå·²é”å®šï¼Œæ— æ³•ä¿®æ”¹');
  }
  // ç®¡ç†å‘˜å¼ºåˆ¶è§£ç»‘éœ€äºŒæ¬¡ç¡®è®¤
  if (request.forceUnbind && !request.confirmationCode) {
    throw new Error('éœ€è¦ç®¡ç†å‘˜ç¡®è®¤ç ');
  }
}
```

### 4.2 å¤‡ç”¨åŸŸåç®¡ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ´»ç é…ç½®é¡µé¢ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤‡ç”¨åŸŸååˆ—è¡¨    â”‚
â”‚ - æ·»åŠ åŸŸå      â”‚ â”€â”€â”€â†’ å¯é€‰ï¼šå¯ç”¨/ç¦ç”¨æ•…éšœè½¬ç§»
â”‚ - åˆ é™¤åŸŸå      â”‚
â”‚ - è°ƒæ•´ä¼˜å…ˆçº§    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ å®æ—¶ç”Ÿæ•ˆ        â”‚
â”‚ (æ— éœ€ç¡®è®¤)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**çµæ´»æ€§ç‰¹ç‚¹**ï¼š
- æ— éœ€ç¡®è®¤å³å¯ä¿®æ”¹
- æ”¯æŒæ‹–æ‹½æ’åºè°ƒæ•´ä¼˜å…ˆçº§
- å¯å•ç‹¬å¯ç”¨/ç¦ç”¨æŸä¸ªå¤‡ç”¨åŸŸå

### 4.3 æ•…éšœè½¬ç§»æµç¨‹

```
ç”¨æˆ·è¯·æ±‚æ´»ç 
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥ä¸»åŸŸåçŠ¶æ€    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
  ä¸»åŸŸåå¯ç”¨ï¼Ÿ
      â”‚
      â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ä¸»åŸŸå
      â”‚         â”‚
      â”‚         â””â”€â†’ è®°å½•æˆåŠŸç»Ÿè®¡
      â”‚
      â””â”€ å¦ â†’ æ•…éšœè½¬ç§»å¯ç”¨ï¼Ÿ
                â”‚
                â”œâ”€ æ˜¯ â†’ ä½¿ç”¨å¤‡ç”¨åŸŸå
                â”‚         â”‚
                â”‚         â”œâ”€â†’ æŒ‰ä¼˜å…ˆçº§é€‰æ‹©
                â”‚         â””â”€â†’ è®°å½•æ•…éšœè½¬ç§»æ—¶é—´
                â”‚
                â””â”€ å¦ â†’ è¿”å›é”™è¯¯
```

**è‡ªåŠ¨åˆ‡æ¢é€»è¾‘**ï¼š
```typescript
async function selectDomainForLiveCode(liveCodeId: string) {
  const liveCode = await getLiveCode(liveCodeId);
  const domainConfig = liveCode.domainConfig;

  // ä¼˜å…ˆä½¿ç”¨ä¸»åŸŸå
  if (domainConfig.primaryDomain) {
    const primary = await getDomain(domainConfig.primaryDomain.domainId);
    if (primary?.status === 'active') {
      return primary;  // ä¸»åŸŸåå¥åº·ï¼Œä½¿ç”¨ä¸»åŸŸå
    }
  }

  // ä¸»åŸŸåä¸å¯ç”¨ï¼Œæ£€æŸ¥å¤‡ç”¨åŸŸå
  if (domainConfig.fallbackDomains.failoverEnabled) {
    for (const domainId of domainConfig.fallbackDomains.domainIds) {
      const fallback = await getDomain(domainId);
      if (fallback?.status === 'active') {
        // è®°å½•æ•…éšœè½¬ç§»
        await recordFailover(liveCodeId, 'fallback', domainId);
        return fallback;
      }
    }
  }

  throw new Error('æ— å¯ç”¨åŸŸå');
}
```

---

## 5. ç”¨æˆ·ç•Œé¢è®¾è®¡

### 5.1 æ´»ç ç¼–è¾‘é¡µé¢ - åŸŸåé…ç½®åŒºåŸŸ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŒ åŸŸåé…ç½®                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ ä¸»åŸŸåé…ç½®                         [é…ç½®è¯´æ˜?]  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ å½“å‰ï¼šæœªç»‘å®š                              â”‚   â”‚
â”‚ â”‚                                         â”‚   â”‚
â”‚ â”‚ [ä»åŸŸåæ± é€‰æ‹©ä¸»åŸŸå]                     â”‚   â”‚
â”‚ â”‚                                         â”‚   â”‚
â”‚ â”‚ âš ï¸ ä¸»åŸŸåä¸€æ—¦ç»‘å®šåä¸å¯ä¿®æ”¹              â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚ å¤‡ç”¨åŸŸåé…ç½®                      [æ•…éšœè½¬ç§»å¼€å…³] â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ å·²æ·»åŠ  2 ä¸ªå¤‡ç”¨åŸŸå                      â”‚   â”‚
â”‚ â”‚                                         â”‚   â”‚
â”‚ â”‚ 1. backup1.com (ä¼˜å…ˆçº§: 1)  [ä¸Šç§»] [åˆ é™¤]â”‚   â”‚
â”‚ â”‚ 2. backup2.com (ä¼˜å…ˆçº§: 2)  [ä¸‹ç§»] [åˆ é™¤]â”‚   â”‚
â”‚ â”‚                                         â”‚   â”‚
â”‚ â”‚ [ä»åŸŸåæ± æ·»åŠ å¤‡ç”¨åŸŸå]                   â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                 â”‚
â”‚ åŸŸåé€‰æ‹©ç­–ç•¥: [ä¼˜å…ˆçº§é€‰æ‹© â–¼]                     â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ä¸»åŸŸåç¡®è®¤å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ ç¡®è®¤ç»‘å®šä¸»åŸŸå                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ æ‚¨å³å°†ç»‘å®šä¸»åŸŸå:                   â”‚
â”‚                                     â”‚
â”‚     primary.example.com             â”‚
â”‚                                     â”‚
â”‚ âš ï¸ é‡è¦æç¤ºï¼š                       â”‚
â”‚ â€¢ ä¸»åŸŸåç»‘å®šåå°†æ°¸ä¹…é”å®š             â”‚
â”‚ â€¢ é”å®šåæ— æ³•ä¿®æ”¹æˆ–æ›´æ¢               â”‚
â”‚ â€¢ ä»…ç®¡ç†å‘˜å¯å¼ºåˆ¶è§£ç»‘                 â”‚
â”‚                                     â”‚
â”‚ [å–æ¶ˆ]              [ç¡®è®¤ç»‘å®š]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 åŸŸåæ± ç®¡ç†é¡µé¢ - æ˜¾ç¤ºç»‘å®šçŠ¶æ€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŸŸååˆ—è¡¨                           [æ·»åŠ åŸŸå]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚ åŸŸå              â”‚ çŠ¶æ€   â”‚ ç»‘å®šä¿¡æ¯  â”‚ æ“ä½œ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ primary1.com      â”‚ ğŸŸ¢ æ´»è·ƒâ”‚ ä¸»åŸŸåÃ—2  â”‚ [æŸ¥çœ‹] â”‚
â”‚                   â”‚        â”‚ å¤‡ç”¨Ã—1   â”‚        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ backup1.com       â”‚ ğŸŸ¢ æ´»è·ƒâ”‚ å¤‡ç”¨Ã—3   â”‚ [æŸ¥çœ‹] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ testing.com       â”‚ ğŸŸ¡ æµ‹è¯•â”‚ æœªç»‘å®š   â”‚ [ç¼–è¾‘] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. API æ¥å£è®¾è®¡

### 6.1 æ´»ç åŸŸåé…ç½® API

```typescript
// GET /api/admin/live-codes/:id/domain-config
// è·å–æ´»ç çš„åŸŸåé…ç½®
interface GetDomainConfigResponse {
  success: boolean;
  data: DomainConfig;
}

// PUT /api/admin/live-codes/:id/domain-config
// æ›´æ–°åŸŸåé…ç½®ï¼ˆå¤‡ç”¨åŸŸåã€ç­–ç•¥ç­‰ï¼‰
interface UpdateDomainConfigRequest {
  fallbackDomains?: {
    domainIds: string[];
    failoverEnabled: boolean;
  };
  strategy?: SelectionStrategy;
}

// POST /api/admin/live-codes/:id/domain-config/primary
// ç»‘å®šä¸»åŸŸåï¼ˆä¸å¯é€†ï¼‰
interface BindPrimaryDomainRequest {
  domainId: string;
  confirmed: boolean;  // å¿…é¡»ä¸ºtrue
}

// DELETE /api/admin/live-codes/:id/domain-config/primary
// è§£ç»‘ä¸»åŸŸåï¼ˆä»…ç®¡ç†å‘˜ï¼Œéœ€å¼ºåˆ¶ç¡®è®¤ï¼‰
interface UnbindPrimaryDomainRequest {
  forceUnbind: boolean;
  confirmationCode: string;  // ç®¡ç†å‘˜ç¡®è®¤ç 
}
```

### 6.2 åŸŸåæ± ç»‘å®šæŸ¥è¯¢ API

```typescript
// GET /api/admin/domain-pool/:id/binding-info
// æŸ¥è¯¢åŸŸåè¢«å“ªäº›æ´»ç ç»‘å®š
interface GetDomainBindingInfoResponse {
  success: boolean;
  data: {
    domainId: string;
    domain: string;
    boundToLiveCodes: {
      liveCodeId: string;
      liveCodeName: string;
      role: 'primary' | 'fallback';
      boundAt: string;
    }[];
  };
}
```

### 6.3 æ´»ç è®¿é—®æ—¶çš„åŸŸåé€‰æ‹© API

```typescript
// GET /api/link/:id
// æ´»ç è®¿é—®å…¥å£ï¼ˆè‡ªåŠ¨é€‰æ‹©åŸŸåï¼‰
interface RedirectResponse {
  // 302 é‡å®šå‘åˆ°é€‰å®šåŸŸå
  targetUrl: string;
  domainUsed: string;
  domainRole: 'primary' | 'fallback';
}
```

---

## 7. å®æ–½é˜¶æ®µ

### Phase 1: æ•°æ®å±‚æ‰©å±•
- æ‰©å±• `server/src/types.ts` ç±»å‹å®šä¹‰
- æ‰©å±• `server/data/live-codes.json` æ•°æ®ç»“æ„
- æ›´æ–° `server/src/storage/live-codes.ts`

### Phase 2: åç«¯ API
- å®ç°åŸŸåé…ç½® CRUD API
- å®ç°ä¸»åŸŸåç»‘å®š/è§£ç»‘é€»è¾‘
- å®ç°æ•…éšœè½¬ç§»é€‰æ‹©é€»è¾‘
- æ›´æ–°æ´»ç è®¿é—®è·¯ç”±

### Phase 3: å‰ç«¯ UI
- åˆ›å»ºåŸŸåé…ç½®ç»„ä»¶
- æ›´æ–°æ´»ç ç¼–è¾‘é¡µé¢
- æ·»åŠ ä¸»åŸŸåç¡®è®¤å¼¹çª—
- æ›´æ–°åŸŸåæ± ç®¡ç†é¡µé¢

### Phase 4: æµ‹è¯•ä¸éªŒè¯
- å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•
- ç”¨æˆ·éªŒæ”¶æµ‹è¯•

---

## 8. é£é™©ä¸ç¼“è§£æªæ–½

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|-----|------|---------|
| ä¸»åŸŸåé”å®šå¯¼è‡´é…ç½®é”™è¯¯æ— æ³•ä¿®å¤ | é«˜ | æä¾›ç®¡ç†å‘˜å¼ºåˆ¶è§£ç»‘åŠŸèƒ½ï¼ˆéœ€äºŒæ¬¡ç¡®è®¤ï¼‰ |
| æ•…éšœè½¬ç§»é€»è¾‘å¤æ‚å¯¼è‡´ Bug | ä¸­ | å……åˆ†çš„å•å…ƒæµ‹è¯• + ç°åº¦å‘å¸ƒ |
| æ€§èƒ½å½±å“ï¼ˆæ¯æ¬¡è®¿é—®éœ€æ£€æŸ¥åŸŸåå¥åº·ï¼‰ | ä½ | ç¼“å­˜åŸŸåçŠ¶æ€ï¼Œå®šæœŸåˆ·æ–° |
| æ•°æ®è¿ç§»å…¼å®¹æ€§ | ä¸­ | ä¿æŒå‘åå…¼å®¹ï¼Œæœªé…ç½®åŸŸåæ—¶ä½¿ç”¨åŸé€»è¾‘ |

---

## 9. æœªæ¥å¢å¼ºæ–¹å‘

1. **æ™ºèƒ½æ¨è**ï¼šæ ¹æ®æ´»ç è®¿é—®é‡è‡ªåŠ¨æ¨èæœ€ä½³ä¸»åŸŸå
2. **åŸŸåé¢„çƒ­**ï¼šæ–°ç»‘å®šä¸»åŸŸåæ—¶è‡ªåŠ¨é¢„çƒ­ DNS
3. **æˆæœ¬ä¼˜åŒ–**ï¼šæ ¹æ® CDN æˆæœ¬è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜åŸŸå
4. **å¤šåŒºåŸŸéƒ¨ç½²**ï¼šæ”¯æŒè·¨åŒºåŸŸçš„åŸŸåæ•…éšœè½¬ç§»
