# åŸŸåæ± ç®¡ç†åŠŸèƒ½è®¾è®¡æ–¹æ¡ˆ

> **ç‰ˆæœ¬**: v1.0
> **è®¾è®¡æ—¥æœŸ**: 2026-01-18
> **çŠ¶æ€**: å¾…å®ç°

---

## 1. éœ€æ±‚åˆ†æ

### 1.1 ä¸‰é“å®‰æ£€é—¨

| ç»´åº¦ | åˆ†æ |
|------|------|
| **åŠ¨æœº (Why)** | è§£å†³å¾®ä¿¡ç­‰å¹³å°å¯¹å•ä¸€åŸŸåçš„å°ç¦é—®é¢˜ã€‚é€šè¿‡åŸŸåè½®æ¢é™ä½å•ä¸€åŸŸåæ›å…‰ç‡ï¼Œå®ç°"å…¥å£ä¸å°åˆ™æµé‡ä¸æŸå¤±" |
| **çœŸä¼ª (Truth)** | **çœŸéœ€æ±‚**ã€‚å¾®ä¿¡æ´»ç ç³»ç»Ÿçš„æ ¸å¿ƒç—›ç‚¹ï¼Œå•ä¸€åŸŸåå®¹æ˜“è¢«å¹³å°è¯†åˆ«å’Œå°ç¦ |
| **å®šä½ (Focus)** | **æ ¸å¿ƒåŠŸèƒ½**ã€‚ä¸æ´»ç ç³»ç»Ÿç´§å¯†è€¦åˆï¼Œå±äºç³»ç»Ÿçš„é˜²å°åŸºç¡€è®¾æ–½ |

### 1.2 æ ¸å¿ƒä»·å€¼

- **é˜²å°èƒ½åŠ›**: é€šè¿‡å¤šåŸŸåè½®æ¢ï¼Œé™ä½å•åŸŸåè¢«å°é£é™©
- **é«˜å¯ç”¨æ€§**: è‡ªåŠ¨æ•…éšœåˆ‡æ¢ï¼Œç¡®ä¿æœåŠ¡è¿ç»­æ€§
- **å¯è§‚æµ‹æ€§**: å®æ—¶ç›‘æ§åŸŸåå¥åº·çŠ¶æ€

---

## 2. æ•°æ®ç»“æ„è®¾è®¡

### 2.1 åŸŸåå®ä½“

```typescript
interface Domain {
  id: string;
  domain: string;              // åŸŸåï¼Œå¦‚ "mtw1.example.com"
  protocol: 'http' | 'https';  // åè®®
  status: DomainStatus;
  weight: number;              // æƒé‡ï¼ˆéšæœºæ¨¡å¼ä½¿ç”¨ï¼‰
  order: number;               // é¡ºåºï¼ˆé¡ºåºæ¨¡å¼ä½¿ç”¨ï¼‰
  healthCheckUrl?: string;     // å¥åº·æ£€æŸ¥è·¯å¾„
  lastCheckTime?: string;      // æœ€åæ£€æŸ¥æ—¶é—´
  lastFailureTime?: string;    // æœ€åå¤±è´¥æ—¶é—´
  failureCount: number;        // è¿ç»­å¤±è´¥æ¬¡æ•°
  totalRequests: number;       // æ€»è¯·æ±‚æ•°
  totalFailures: number;       // æ€»å¤±è´¥æ•°
  createdAt: string;
  updatedAt: string;
}

type DomainStatus = 'active' | 'inactive' | 'banned' | 'testing';
```

### 2.2 åŸŸåæ± é…ç½®

```typescript
interface DomainPoolConfig {
  id: string;
  name: string;                // æ± åç§°ï¼Œå¦‚ "ä¸»åŸŸåæ± "
  strategy: SelectionStrategy;
  domains: Domain[];           // åŸŸååˆ—è¡¨
  maxFailures: number;         // æœ€å¤§è¿ç»­å¤±è´¥æ¬¡æ•°ï¼ˆé»˜è®¤3æ¬¡ï¼‰
  healthCheckInterval: number; // å¥åº·æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼Œé»˜è®¤300ï¼‰
  retryInterval: number;       // å¤±è´¥é‡è¯•é—´éš”ï¼ˆç§’ï¼Œé»˜è®¤60ï¼‰
  currentIndex: number;        // å½“å‰è½®è¯¢ç´¢å¼•
  isActive: boolean;           // æ˜¯å¦å¯ç”¨æ­¤æ± 
  createdAt: string;
  updatedAt: string;
}

type SelectionStrategy = 'round-robin' | 'random' | 'weighted';
```

### 2.3 åŸŸåé€‰æ‹©ç»“æœ

```typescript
interface DomainSelection {
  domain: string;
  fullUrl: string;
  poolId: string;
  domainId: string;
}
```

---

## 3. æ ¸å¿ƒæµç¨‹è®¾è®¡

### 3.1 åŸŸåé€‰æ‹©æµç¨‹

```mermaid
flowchart TD
    A[ç”¨æˆ·è¯·æ±‚æ´»ç ] --> B[è·å–æ´»ç é…ç½®]
    B --> C{åŸŸåæ± æ˜¯å¦å¯ç”¨?}
    C -->|å¦| D[ä½¿ç”¨ mainUrl ç›´æ¥è·³è½¬]
    C -->|æ˜¯| E[è·å–åŸŸåæ± é…ç½®]

    E --> F{é€‰æ‹©ç­–ç•¥}
    F -->|round-robin| G[æŒ‰ currentIndex é€‰æ‹©åŸŸå]
    F -->|random| H[éšæœºé€‰æ‹©å¯ç”¨åŸŸå]
    F -->|weighted| I[æŒ‰æƒé‡éšæœºé€‰æ‹©]

    G --> J{åŸŸåçŠ¶æ€æ£€æŸ¥}
    H --> J
    I --> J

    J -->|status=active| K[æ›´æ–°ç»Ÿè®¡å¹¶è¿”å›URL]
    J -->|statusâ‰ active| L[è·³è¿‡è¯¥åŸŸå]

    L --> M{è¿˜æœ‰å¯ç”¨åŸŸå?}
    M -->|æ˜¯| F
    M -->|å¦| N[é™çº§: ä½¿ç”¨ mainUrl]

    K --> O[é€’å¢ currentIndex<br/>æ›´æ–°è¯·æ±‚ç»Ÿè®¡]
    O --> P[è¿”å›å®Œæ•´URL]

    D --> P
    N --> P
```

### 3.2 å¥åº·æ£€æŸ¥æµç¨‹

```mermaid
flowchart TD
    A[å®šæ—¶ä»»åŠ¡è§¦å‘] --> B[éå†æ‰€æœ‰åŸŸåæ± ]
    B --> C{æ± æ˜¯å¦å¯ç”¨?}
    C -->|å¦| B
    C -->|æ˜¯| D[éå†æ± ä¸­æ¯ä¸ªåŸŸå]

    D --> E[å‘é€å¥åº·æ£€æŸ¥è¯·æ±‚]
    E --> F{HTTPçŠ¶æ€ç }

    F -->|200-299| G[é‡ç½®å¤±è´¥è®¡æ•°ä¸º0]
    F -->|å…¶ä»–| H[å¤±è´¥è®¡æ•°+1]

    H --> I{å¤±è´¥è®¡æ•° >= maxFailures?}
    I -->|æ˜¯| J[æ ‡è®°ä¸º banned]
    I -->|å¦| K[ä¿æŒå½“å‰çŠ¶æ€]

    G --> L[å¦‚æœçŠ¶æ€ä¸ºbannedåˆ™æ¢å¤ä¸ºactive]
    J --> M[æ›´æ–°æœ€åå¤±è´¥æ—¶é—´]
    K --> M
    L --> M

    M --> N[æ›´æ–°æœ€åæ£€æŸ¥æ—¶é—´]
    N --> O{è¿˜æœ‰åŸŸå?}
    O -->|æ˜¯| D
    O -->|å¦| P[ä¿å­˜é…ç½®]
```

---

## 4. API æ¥å£è®¾è®¡

### 4.1 åŸŸåæ± é…ç½®

```typescript
// GET /api/admin/domain-pool
interface GetDomainPoolResponse {
  success: boolean;
  data: {
    config: DomainPoolConfig;
    statistics: {
      totalDomains: number;
      activeDomains: number;
      bannedDomains: number;
      inactiveDomains: number;
      testingDomains: number;
      totalRequests: number;
      totalFailures: number;
      successRate: number;
    };
  };
}

// PUT /api/admin/domain-pool/config
interface UpdatePoolConfigRequest {
  strategy?: SelectionStrategy;
  maxFailures?: number;
  healthCheckInterval?: number;
  retryInterval?: number;
  isActive?: boolean;
}

interface UpdatePoolConfigResponse {
  success: boolean;
  data?: DomainPoolConfig;
  message?: string;
}
```

### 4.2 åŸŸåç®¡ç†

```typescript
// POST /api/admin/domain-pool/domains
interface AddDomainRequest {
  domain: string;
  protocol: 'http' | 'https';
  weight?: number;
  order?: number;
  healthCheckUrl?: string;
}

interface AddDomainResponse {
  success: boolean;
  data?: Domain;
  message?: string;
}

// PUT /api/admin/domain-pool/domains/:id
interface UpdateDomainRequest {
  domain?: string;
  protocol?: 'http' | 'https';
  status?: DomainStatus;
  weight?: number;
  order?: number;
  healthCheckUrl?: string;
}

interface UpdateDomainResponse {
  success: boolean;
  data?: Domain;
  message?: string;
}

// DELETE /api/admin/domain-pool/domains/:id
interface DeleteDomainResponse {
  success: boolean;
  message?: string;
}

// POST /api/admin/domain-pool/domains/:id/toggle
// åˆ‡æ¢åŸŸåçŠ¶æ€ (active <-> inactive)
interface ToggleDomainResponse {
  success: boolean;
  data?: Domain;
  message?: string;
}
```

### 4.3 å¥åº·æ£€æŸ¥

```typescript
// POST /api/admin/domain-pool/health-check
// æ‰‹åŠ¨è§¦å‘å¥åº·æ£€æŸ¥
interface HealthCheckResponse {
  success: boolean;
  data: {
    checked: number;
    healthy: number;
    unhealthy: number;
    results: Array<{
      domainId: string;
      domain: string;
      status: 'ok' | 'failed';
      responseTime?: number;
      error?: string;
    }>;
  };
}
```

### 4.4 åŸŸåé€‰æ‹©ï¼ˆä¾›è·³è½¬ä½¿ç”¨ï¼‰

```typescript
// GET /api/admin/domain-pool/select
// è·å–ä¸‹ä¸€ä¸ªå¯ç”¨åŸŸå
interface SelectDomainResponse {
  success: boolean;
  data?: DomainSelection;
  message?: string;
}
```

---

## 5. æ•°æ®å­˜å‚¨ç»“æ„

### 5.1 æ–‡ä»¶è·¯å¾„

```
server/data/
â”œâ”€â”€ live-codes.json    # æ´»ç æ•°æ®
â””â”€â”€ domain-pool.json   # åŸŸåæ± æ•°æ® (æ–°å¢)
```

### 5.2 JSON ç»“æ„

```json
{
  "config": {
    "id": "pool-main",
    "name": "ä¸»åŸŸåæ± ",
    "strategy": "round-robin",
    "maxFailures": 3,
    "healthCheckInterval": 300,
    "retryInterval": 60,
    "currentIndex": 0,
    "isActive": true,
    "createdAt": "2026-01-18T00:00:00.000Z",
    "updatedAt": "2026-01-18T00:00:00.000Z"
  },
  "domains": [
    {
      "id": "domain-1",
      "domain": "mtw1.example.com",
      "protocol": "https",
      "status": "active",
      "weight": 1,
      "order": 1,
      "healthCheckUrl": "/health",
      "lastCheckTime": "2026-01-18T12:00:00.000Z",
      "failureCount": 0,
      "totalRequests": 1234,
      "totalFailures": 5,
      "createdAt": "2026-01-18T00:00:00.000Z",
      "updatedAt": "2026-01-18T12:00:00.000Z"
    },
    {
      "id": "domain-2",
      "domain": "mtw2.example.com",
      "protocol": "https",
      "status": "active",
      "weight": 1,
      "order": 2,
      "healthCheckUrl": "/health",
      "lastCheckTime": "2026-01-18T12:00:00.000Z",
      "failureCount": 0,
      "totalRequests": 1180,
      "totalFailures": 3,
      "createdAt": "2026-01-18T00:00:00.000Z",
      "updatedAt": "2026-01-18T12:00:00.000Z"
    }
  ]
}
```

---

## 6. UI è®¾è®¡

### 6.1 åŸŸåæ± ç®¡ç†é¡µé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LinkOS ç®¡ç†åå°                              [ç®¡ç†å‘˜å¤´åƒ]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š ä»ªè¡¨ç›˜  â”‚  ğŸ“± æˆ‘çš„æ´»ç   â”‚  ğŸŒ åŸŸåæ± ç®¡ç†  â”‚  ğŸ“Š æ•°æ®    â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŸŸåæ± é…ç½®                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å½“å‰ç­–ç•¥: [é¡ºåºè½®è¯¢ â–¼]  æ± çŠ¶æ€: [â—å¯ç”¨/â—‹åœç”¨]            â”‚  â”‚
â”‚  â”‚  æœ€å¤§å¤±è´¥æ¬¡æ•°: [3]  æ£€æŸ¥é—´éš”: [300ç§’]                    â”‚  â”‚
â”‚  â”‚  [ä¿å­˜é…ç½®]  [æ‰‹åŠ¨å¥åº·æ£€æŸ¥]                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  åŸŸååˆ—è¡¨                                    [+ æ·»åŠ åŸŸå]   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ åºå· â”‚ åŸŸå             â”‚ çŠ¶æ€    â”‚ æƒé‡ â”‚ æ“ä½œ       â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  1   â”‚ mtw1.xxx.com     â”‚ ğŸŸ¢æ´»è·ƒ  â”‚  1   â”‚ ç¼–è¾‘/åˆ é™¤  â”‚  â”‚
â”‚  â”‚  2   â”‚ mtw2.xxx.com     â”‚ ğŸ”´å°ç¦  â”‚  1   â”‚ ç¼–è¾‘/åˆ é™¤  â”‚  â”‚
â”‚  â”‚  3   â”‚ mtw3.xxx.com     â”‚ ğŸŸ¡æµ‹è¯•  â”‚  2   â”‚ ç¼–è¾‘/åˆ é™¤  â”‚  â”‚
â”‚  â”‚  4   â”‚ mtw4.xxx.com     â”‚ âšªåœç”¨  â”‚  1   â”‚ ç¼–è¾‘/åˆ é™¤  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  ç»Ÿè®¡ä¿¡æ¯                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ€»åŸŸå: 15 â”‚ æ´»è·ƒ: 12 â”‚ å°ç¦: 2 â”‚ åœç”¨: 1              â”‚  â”‚
â”‚  â”‚ ä»Šæ—¥è¯·æ±‚: 1,234 â”‚ æˆåŠŸç‡: 98.5%                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 æ·»åŠ /ç¼–è¾‘åŸŸåå¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ·»åŠ åŸŸå                  [Ã—]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ ‡è®° * å¿…å¡«                          â”‚
â”‚                                       â”‚
â”‚  åŸŸå *                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ mtw.example.com                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                       â”‚
â”‚  åè®® *                               â”‚
â”‚  â—‹ HTTPS  â— HTTP                      â”‚
â”‚                                       â”‚
â”‚  æƒé‡ (éšæœºæ¨¡å¼)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                       â”‚
â”‚  å¥åº·æ£€æŸ¥è·¯å¾„                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ /health                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                       â”‚
â”‚  [å–æ¶ˆ]              [ä¿å­˜]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 çŠ¶æ€è¯´æ˜

| çŠ¶æ€ | å›¾æ ‡ | è¯´æ˜ |
|------|------|------|
| active (æ´»è·ƒ) | ğŸŸ¢ | åŸŸåæ­£å¸¸ä½¿ç”¨ä¸­ |
| banned (å°ç¦) | ğŸ”´ | è¿ç»­å¤±è´¥è¶…è¿‡é˜ˆå€¼ï¼Œè¢«æ ‡è®°ä¸ºå°ç¦ |
| inactive (åœç”¨) | âšª | æ‰‹åŠ¨åœç”¨ï¼Œä¸å‚ä¸è½®æ¢ |
| testing (æµ‹è¯•) | ğŸŸ¡ | æ–°æ·»åŠ æˆ–æ¢å¤ï¼Œè§‚å¯Ÿä¸­ |

---

## 7. é€‰æ‹©ç­–ç•¥è¯¦è§£

### 7.1 é¡ºåºè½®è¯¢ (round-robin)

- æŒ‰ç…§åŸŸåçš„ `order` å­—æ®µé¡ºåºä¾æ¬¡é€‰æ‹©
- æ¯æ¬¡é€‰æ‹©å `currentIndex + 1`
- åˆ°è¾¾æœ«å°¾åä»å¤´å¼€å§‹
- è·³è¿‡é `active` çŠ¶æ€çš„åŸŸå

### 7.2 éšæœºé€‰æ‹© (random)

- ä»æ‰€æœ‰ `active` çŠ¶æ€çš„åŸŸåä¸­éšæœºé€‰æ‹©
- æ¯ä¸ªåŸŸåè¢«é€‰ä¸­çš„æ¦‚ç‡ç›¸ç­‰

### 7.3 æƒé‡éšæœº (weighted)

- æ ¹æ® `weight` å­—æ®µè®¡ç®—æƒé‡
- æƒé‡è¶Šé«˜ï¼Œè¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šå¤§
- åªä» `active` çŠ¶æ€çš„åŸŸåä¸­é€‰æ‹©

---

## 8. è¾¹ç•Œæƒ…å†µå¤„ç†

| åœºæ™¯ | å¤„ç†æ–¹å¼ |
|------|----------|
| åŸŸåæ± ä¸ºç©º | è¿”å› nullï¼Œè°ƒç”¨æ–¹ä½¿ç”¨ mainUrl é™çº§ |
| æ‰€æœ‰åŸŸåè¢«å° | è¿”å› nullï¼Œè°ƒç”¨æ–¹ä½¿ç”¨ mainUrl é™çº§ |
| å¥åº·æ£€æŸ¥å…¨éƒ¨å¤±è´¥ | ä¿æŒå½“å‰çŠ¶æ€ä¸å˜ï¼Œç­‰å¾…ä¸‹æ¬¡æ£€æŸ¥ |
| å¹¶å‘é€‰æ‹©åŸŸå | ä½¿ç”¨æ–‡ä»¶é”ä¿è¯åŸå­æ€§ |
| åŸŸåè§£æå¤±è´¥ | è®¡å…¥å¤±è´¥æ¬¡æ•°ï¼Œè¿ç»­å¤±è´¥åæ ‡è®°ä¸º banned |

---

## 9. æ€§èƒ½è€ƒè™‘

- å¥åº·æ£€æŸ¥é‡‡ç”¨å¼‚æ­¥éé˜»å¡æ–¹å¼
- åŸŸåé€‰æ‹©ä½¿ç”¨å†…å­˜ç¼“å­˜ï¼ˆè¯»å–æ—¶åŒæ­¥ï¼Œæ›´æ–°æ—¶å¼‚æ­¥ï¼‰
- ç»Ÿè®¡æ•°æ®é‡‡ç”¨è®¡æ•°å™¨æ¨¡å¼ï¼Œé¿å…æ¯æ¬¡å…¨é‡è®¡ç®—

---

## 10. å®æ–½è®¡åˆ’

### Phase 1: åç«¯åŸºç¡€
- [ ] åˆ›å»ºåŸŸåæ± æ•°æ®å­˜å‚¨æœåŠ¡
- [ ] å®ç°åŸŸåæ±  CRUD API
- [ ] å®ç°ä¸‰ç§é€‰æ‹©ç­–ç•¥

### Phase 2: åç«¯é«˜çº§
- [ ] å®ç°å¥åº·æ£€æŸ¥å®šæ—¶ä»»åŠ¡
- [ ] å®ç°ç»Ÿè®¡æ•°æ®æ›´æ–°
- [ ] å®ç°é™çº§æœºåˆ¶

### Phase 3: å‰ç«¯å®ç°
- [ ] åˆ›å»ºåŸŸåæ± ç®¡ç†é¡µé¢
- [ ] å®ç°åŸŸååˆ—è¡¨å’Œå¢åˆ æ”¹
- [ ] å®ç°é…ç½®é¢æ¿
- [ ] é›†æˆåˆ°å¯¼èˆªç³»ç»Ÿ

### Phase 4: æµ‹è¯•éªŒè¯
- [ ] å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•

---

## 11. å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
|------|------|---------|
| v1.0 | 2026-01-18 | åˆå§‹ç‰ˆæœ¬ |

---

## Sources
- [æ´»ç äºŒç»´ç (åŠ¨æ€äºŒç»´ç )åŸŸåæ± ä»‹ç»](https://blog.csdn.net/yinyueboke/article/details/122068281)
- [å¿«ç ã€æ´»ç ã€‘é˜²å°æŒ‡å—](https://zhuanlan.zhihu.com/p/377699663)
- [å²ä¸Šæœ€å…¨å¾®ä¿¡åŸŸåé˜²å°APIåŸç†åŠå®ç°æ–¹æ¡ˆ](https://cloud.tencent.com/developer/article/1602820)
